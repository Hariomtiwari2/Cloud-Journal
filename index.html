<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloud Diary (Public Demo)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="h-screen bg-gray-100">

<div class="flex h-screen">

  <!-- LEFT SIDEBAR -->
  <div class="w-1/3 md:w-1/4 bg-white border-r flex flex-col">

    <div class="p-4 border-b flex justify-between items-center">
      <h2 class="text-lg font-bold">My Entries</h2>
      <button onclick="openNewEntry()"
        class="bg-green-500 text-white px-3 py-1 rounded-lg text-sm">
        + New
      </button>
    </div>

    <div id="entryList" class="flex-1 overflow-y-auto"></div>

  </div>

  <!-- RIGHT PANEL -->
  <div class="flex-1 flex flex-col">

    <div id="mainPanel"
      class="flex-1 p-8 overflow-y-auto bg-gray-50">

      <div class="text-gray-400 text-center mt-40">
        Select an entry or create a new one
      </div>

    </div>

  </div>

</div>

<script>
/* =====================================================
   PUBLIC DEMO MODE
   - No authentication
   - No backend
   - No token storage
   - Safe for public repositories
   ===================================================== */

/*
  TODO (private version only):
  - Add OAuth (Cognito/Auth0/etc)
  - Use access tokens (not id tokens)
  - Store tokens in HttpOnly cookies
  - Sanitize rich text before saving/rendering
*/

let entries = [];
let entryCounter = 1;

/* ============================= */
/* ENTRY LIST                    */
/* ============================= */

function renderEntryList() {
  const list = document.getElementById("entryList");
  list.innerHTML = "";

  entries.forEach(entry => {
    const div = document.createElement("div");
    div.className =
      "p-4 border-b cursor-pointer hover:bg-gray-100 transition";

    div.textContent = entry.preview;
    div.onclick = () => openEntry(entry);

    list.appendChild(div);
  });
}

/* ============================= */
/* ENTRY VIEW                    */
/* ============================= */

function openEntry(entry) {
  document.getElementById("mainPanel").innerHTML = `
    <div class="max-w-3xl mx-auto">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Your Entry</h2>
        <button onclick="deleteEntry(${entry.id})"
          class="text-red-500 hover:underline">
          Delete
        </button>
      </div>

      <div class="bg-white p-6 rounded-xl shadow text-lg whitespace-pre-wrap">
        ${escapeHTML(entry.content)}
      </div>
    </div>
  `;
}

/* ============================= */
/* NEW ENTRY                     */
/* ============================= */

function openNewEntry() {
  document.getElementById("mainPanel").innerHTML = `
    <div class="max-w-3xl mx-auto">
      <h2 class="text-2xl font-bold mb-4">New Entry</h2>

      <textarea id="editor"
        class="border p-6 rounded-xl min-h-[300px] w-full bg-white focus:outline-none"
        placeholder="Write your thoughts..."></textarea>

      <button onclick="saveEntry()"
        class="mt-6 bg-green-600 text-white px-6 py-2 rounded-lg">
        Save
      </button>
    </div>
  `;
}

/* ============================= */
/* DATA HANDLING (SAFE)          */
/* ============================= */

function saveEntry() {
  const content = document.getElementById("editor").value.trim();
  if (!content) return;

  entries.unshift({
    id: entryCounter++,
    content,
    preview: content.slice(0, 40) + (content.length > 40 ? "â€¦" : "")
  });

  renderEntryList();
  openEntry(entries[0]);
}

function deleteEntry(id) {
  entries = entries.filter(e => e.id !== id);
  renderEntryList();

  document.getElementById("mainPanel").innerHTML = `
    <div class="text-gray-400 text-center mt-40">
      Entry deleted
    </div>
  `;
}

/* ============================= */
/* UTIL                          */
/* ============================= */

function escapeHTML(str) {
  return str
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}
</script>

</body>
</html>
